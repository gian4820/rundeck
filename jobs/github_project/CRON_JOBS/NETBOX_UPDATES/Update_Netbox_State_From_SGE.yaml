- defaultTab: nodes
  description: Update SGE status to Netbox status
  executionEnabled: true
  group: CRON_JOBS/NETBOX_UPDATES
  id: eda81af4-ab4b-42a7-842f-808da953e5b8
  loglevel: WARN
  name: Update_Netbox_State_From_SGE
  nodeFilterEditable: true
  nodefilters:
    dispatch:
      excludePrecedence: true
      keepgoing: true
      rankOrder: ascending
      successOnEmptyNodeFilter: false
      threadcount: '50'
    filter: 'tags: sge_execution_host'
    filterExclude: 'name: gbnwp-vrdsrv001.it.graphcore.ai,gbnwp-vrdsrv002.it.graphcore.ai,gbnwp-vrdsrv001,gbnwp-vrdsrv002,gbnwp-vfarmansible001.it.graphcore.ai
      name: !.*'
  nodesSelectedByDefault: false
  notification:
    onfailure:
      plugin:
        configuration:
          slack_channel: '#it-alerts-rundeck-application'
          webhook_base_url: https://hooks.slack.com/services/
          webhook_token: T2GU9J9CL/B04SN7LH1NG/vFIK3uv1Lx6ivaAa88hrix4e
        type: SlackNotification
  notifyAvgDurationThreshold: 1h
  options:
  - hidden: true
    name: NETBOX_API_TOKEN
    required: true
    secure: true
    storagePath: keys/thycotic/IT/Linux/Rundeck/svcitnetbox-netbox002
    valueExposed: true
  plugins:
    ExecutionLifecycle: {}
  schedule:
    dayofmonth:
      day: '*'
    month: '*'
    time:
      hour: '*/2'
      minute: '5'
      seconds: '0'
    year: '*'
  scheduleEnabled: true
  schedules: []
  sequence:
    commands:
    - configuration:
        ansible-base-dir-path: /var/lib/rundeck/projects/IS_FARM/ScmImport/ansible-env/
        ansible-become: 'false'
        ansible-binaries-dir-path: /var/lib/rundeck/projects/IS_FARM/python-venv/project-main-ansible-2.14.4/bin/
        ansible-extra-param: --forks 32
        ansible-extra-vars: |-
          ipmi_password: ${option.IPMI_ADMIN}
          ansible_ipmi: ${node.ipmi_fqdn}
          netbox_token: ${option.NETBOX_API_TOKEN}
        ansible-playbook: playbooks/include-tasks/Netbox_Commands/Update_Netbox_State_From_SGE.yaml
        ansible-ssh-auth-type: privateKey
        ansible-ssh-key-storage-path: null
        ansible-ssh-keypath: /localhome/rundeck/.ssh/id_ed25519
        ansible-ssh-passphrase-option: option.password
        ansible-ssh-passphrase-storage-path: keys/thycotic/IT/Linux/Rundeck/gc_ssh_rundeck_server_ed25519_passphrase
        ansible-ssh-use-agent: 'true'
        ansible-ssh-user: rundeck
      nodeStep: true
      type: com.batix.rundeck.plugins.AnsiblePlaybookWorflowNodeStep
    keepgoing: true
    strategy: node-first
  uuid: eda81af4-ab4b-42a7-842f-808da953e5b8

